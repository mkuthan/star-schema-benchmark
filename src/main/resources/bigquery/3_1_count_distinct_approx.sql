SELECT
    C_NATION,
    S_NATION,
    EXTRACT(YEAR FROM LO_ORDERDATE) AS year,
    SUM(LO_REVENUE) AS revenue,
    APPROX_COUNT_DISTINCT(LO_CUSTKEY) AS unique_customers
FROM `lineorder_flat`
WHERE C_REGION = 'ASIA' AND S_REGION = 'ASIA'
  AND EXTRACT(YEAR FROM LO_ORDERDATE) >= 1992 AND EXTRACT(YEAR FROM LO_ORDERDATE) <= 1997
GROUP BY C_NATION, S_NATION, year
ORDER BY year ASC, revenue DESC

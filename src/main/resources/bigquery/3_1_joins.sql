SELECT
    C.C_NATION,
    S.S_NATION,
    EXTRACT(YEAR FROM LO.LO_ORDERDATE) AS year,
    SUM(LO.LO_REVENUE) AS revenue
FROM `lineorder` AS LO
    INNER JOIN `customer` AS C ON C.C_CUSTKEY = LO.LO_CUSTKEY
    INNER JOIN `supplier` AS S ON S.S_SUPPKEY = LO.LO_SUPPKEY
WHERE C.C_REGION = 'ASIA' AND S.S_REGION = 'ASIA'
  AND EXTRACT(YEAR FROM LO.LO_ORDERDATE) >= 1992 AND EXTRACT(YEAR FROM LO.LO_ORDERDATE) <= 1997
GROUP BY C.C_NATION, S.S_NATION, year
ORDER BY year ASC, revenue DESC

SELECT
    EXTRACT(YEAR FROM __time) AS "year",
    S_CITY,
    P_BRAND,
    SUM(LO_REVENUE - LO_SUPPLYCOST) AS profit
FROM "__DRUID_DATASOURCE__"
WHERE S_NATION = 'UNITED STATES'
  AND (EXTRACT(YEAR FROM __time) = 1997 OR EXTRACT(YEAR FROM __time) = 1998)
  AND P_CATEGORY = 'MFGR#14'
GROUP BY 1, S_CITY, P_BRAND
ORDER BY 1 ASC, S_CITY ASC, P_BRAND ASC

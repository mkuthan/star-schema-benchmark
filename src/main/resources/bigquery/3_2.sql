SELECT
    C_CITY,
    S_CITY,
    EXTRACT(YEAR FROM LO_ORDERDATE) AS year,
    SUM(LO_REVENUE) AS revenue
FROM `lineorder_flat`
WHERE C_NATION = 'UNITED STATES' AND S_NATION = 'UNITED STATES'
  AND EXTRACT(YEAR FROM LO_ORDERDATE) >= 1992 AND EXTRACT(YEAR FROM LO_ORDERDATE) <= 1997
GROUP BY C_CITY, S_CITY, year
ORDER BY year ASC, revenue DESC

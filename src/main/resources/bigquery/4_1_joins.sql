SELECT
    EXTRACT(YEAR FROM LO.LO_ORDERDATE) AS year,
    C.C_NATION,
    SUM(LO.LO_REVENUE - LO.LO_SUPPLYCOST) AS profit
FROM `lineorder_flat` AS LO
    INNER JOIN `customer` AS C ON C.C_CUSTKEY = LO.LO_CUSTKEY
    INNER JOIN `supplier` AS S ON S.S_SUPPKEY = LO.LO_SUPPKEY
    INNER JOIN `part` AS P ON P.P_PARTKEY = LO.LO_PARTKEY
WHERE C.C_REGION = 'AMERICA' AND S.S_REGION = 'AMERICA' AND (P.P_MFGR = 'MFGR#1' OR P.P_MFGR = 'MFGR#2')
GROUP BY year, C.C_NATION
ORDER BY year ASC, C.C_NATION ASC
